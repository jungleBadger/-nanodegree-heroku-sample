<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>login</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">
    </script>

    <script src="//apis.google.com/js/platform.js?onload=start"></script>
</head>
<body>
<div>
    <div id="signinButton">
          <span class="g-signin"
                data-scope="openid email"
                data-clientid="322614347596-82b4vh2b21b9tc28k0hsv91d76vmdbeo.apps.googleusercontent.com"
                data-redirecturi="postmessage"
                data-accesstype="offline"
                data-cookiepolicy="single_host_origin"
                data-callback="signInCallback"
                data-approvalprompt="force">
          </span>

        <div id="result"></div>
    </div>

</div>
<script>
           let elements = {
                     "signInButton": $("signInButton")
                 }

                 let factory = {

                 };

                 function signInCallback(authResult) {
                 console.log(authResult);
                     if (authResult && authResult.code) {

                         elements.signInButton.hide();
                         $.ajax({
                                 type: 'POST',
                                 url: '/gconnect?state={{STATE}}',
                                 processData: false,
                                 data: authResult['code'],
                                 contentType: 'application/octet-stream; charset=utf-8',
                                 success: function(result) {
                                     // Handle or verify the server response if necessary.
                                     if (result) {
                                         $('#result').html('Login Successful!</br>' + result + '</br>Redirecting...')
                                         setTimeout(function() {
                                             window.location.href = "/restaurant";
                                         }, 4000);

                                     } else if (authResult['error']) {
                                         console.log('There was an error: ' + authResult['error']);
                                     } else {
                                         $('#result').html('Failed to make a server-side call. Check your configuration and console.');
                                     }
                                 }
                             });
                         }

                     }

</script>
</body>
</html>